---
title: "model"
author:
- Kevin Ha - 571821
- Ola Andre Olofsson - 170745
fontsize: 12pt
linestrech: 1.5
output:
  pdf_document: default
  html_document:
    df_print: paged
  word_document: default
lang: no-NB
---

```{r setup, include=FALSE}
suppressPackageStartupMessages({
library(tidyverse)
library(lubridate)
library(modelr)
library(broom)
library(lmtest)
library(sandwich)
library(viridis)
})
knitr::opts_chunk$set(echo=FALSE, include = FALSE)
```

# Modeller

## Leser inn data

```{r reading file}
pm2 <- read_csv("data/pm2.csv", show_col_types = FALSE)
```

Vi er interessert i fylkesnummeret (de to første siffrene i kommunenummeret). Vi bruker mutate() for å gjøre om kolonner for kommunenummer om til typen "factor"

```{r konvertering til faktor}
pm2 <- pm2 %>% 
  mutate(
    fnr = str_sub(knr, 1,2),
    aar_f = str_sub(aar))
```

-

```{r parserer faktorer}
pm2 %>% 
  mutate(
    fnr = parse_factor(fnr, levels = fnr),
    aar_f = parse_factor(aar_f, levels = aar_f))
```

-

```{r skalerer Trade_pc}
pm2 <- pm2 %>%
  mutate(Trade_pc_100K = Trade_pc/100000) 
```

-

```{r visuell kontroll}
head(pm2, n = 4)
```

## Modell

```{r starter med følgende oppgitte modell}
mod1 <- 'pm2 ~ aar_f + Totalt_ya_p + inc_k1 + inc_k5 + mf_uni_k + mf_uni_l + Trade_pc_100K'
```

### i. generer et lm objekt (lm1) utfra mod1 og datasettet pm2.

```{r}
lm1 <- lm(mod1)
```

```{r Summary}
summary(lm1)
```


### ii. Legg residualene fra den lineære modellen til datasettet pm2.

```{r legger til residualer}
pm2 %>%
  add_residuals(lm1)
```

### Breuch-Pagen test for heteroskedastisitet

```{r}
bptest(lm1)
```

Vi ser at p-verdien er X.XXX, og ser dermed grunnlag for heteroskedastisitet.
Nullhypotesen forkastes dersom p-verdien er lavere enn 5%. I dette tilfellet vurderes det dithen at nullhypotesen forkastes (ikke) ettersom p-verdien er X.XXX

# Dummy

